"use strict";function sendMessage(n){console.log("Message sent : ");connection.send(NEW_MESSAGE,n)}function sendInvitation(n){console.log("Invitation sent to : "+n);connection.send(INVITATION_SEND,n)}function ajaxRequestParams(n,t,i){return __awaiter(this,void 0,void 0,function*(){return new Promise((r,u)=>{var f=$.ajax({type:n,url:t,data:i});f.done(function(n){r(n)});f.fail(function(n){u(n)})})})}function loadChannels(){var n=ajaxRequestParams("POST","api/getChannels","",null);n.then(function(n){channels=n;channelList.html("");channels.forEach(n=>{n.element=new GUIChannelListElement($(".channel-list"),n);let t=new GUIButton(n.element.selector,"Join",()=>{joinChannel(n.id)});n.element.Render();t.Render();t.selector.addClass("float-right")})})}function addMessageToFeed(n,t,i){console.log("Adding message to channel "+i);new GUIChatFeedElement(feedList,n,t);let r=conversations[i];r.add(new GUIChatFeedElement($("#"+i),n,t))}function loadUsers(n){users=[];var t=ajaxRequestParams("POST","api/Channels/"+n+"/users","",null);t.then(function(n){userList.html("");let t=n;t.forEach(n=>addUserToChannel(n))})}function removeUserFromList(n){if(users.length>=0){var t=users.filter(t=>t.login==n)[0];t.element.Remove();users=users.filter(n=>n.login!=n.login)}}function getBadgeColor(n){return n>100?"badge-danger":n>50?"badge-warning":n>25?"badge-success":"badge-secondary"}function joinChannel(n){return __awaiter(this,void 0,void 0,function*(){yield ajaxRequestParams("POST","api/Channels/"+n+"/join","",null).then(t=>{feedList.html(""),loadChannels(),loadUsers(n),currentChannelName=t,addChatTab(t),conversations[t]=new Conversation(currentChannelName,CONVERSATION_STATUS.ACCEPTED)})})}function generateRandomString(n){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<n;r++)t+=i.charAt(Math.floor(Math.random()*i.length));return t}function strip(n){return n.replace(/<(?:.|\n)*?>/gm,"")}function addUserToChannel(n){try{n.element=new GUIUserListElement($(".user-list"),n);let t=new GUIButton(n.element.selector,"Invite",()=>{sendInvitation(n.login)}),i=new GUIButton(n.element.selector,"Block",()=>{});t.selector.addClass("invite-btn float-right");i.selector.addClass("block-btn float-right");n.element.Render();i.Render();t.Render();users.push(n)}catch(t){console.log(t)}}function addChatTab(n){let t=new GUIChatTabElement(chatTabs,n),i=new Conversation(n,CONVERSATION_STATUS.PENDING);conversations[n]=i;t.Render()}function loadConversation(n){let t=conversations[n];feedList.html("");feedList.append(t.get())}var currentChannelName="Global",channelList=$(".channel-list"),userList=$(".user-list"),feedList=$(".feed-list"),chatTabs=$(".chat-tabs"),userMessage=$(".message"),channels=[],users=[],conversations={},CONVERSATION_STATUS,__awaiter;userMessage.keypress(function(n){switch(n.key){case"Enter":sendMessage(userMessage.val());userMessage.val("")}});$(".body").fadeTo("slow",.8);const connection=(new signalR.HubConnectionBuilder).withUrl("/hub").configureLogging(signalR.LogLevel.Information).build();(function(n){n[n.PENDING=0]="PENDING";n[n.ACCEPTED=1]="ACCEPTED";n[n.REJECTED=2]="REJECTED";n[n.BLOCKED=3]="BLOCKED"})(CONVERSATION_STATUS||(CONVERSATION_STATUS={}));const USER_LEFT_CHANNEL="userLeftChannel",USER_JOINED_CHANNEL="userJoinedChannel",USER_CONNECTION_TIMEOUT="userConnectionTimeOut",USER_DISCONNECTED="userDisconnected",CHANNEL_MESSAGE_RECEIVED="channelMessageReceived",PRIVATE_MESSAGE_RECEIVED="privateMessageReceived",INVITATION_RECEIVED="invitationReceived",INVITATION_SEND="invitationSend",NEW_MESSAGE="newMessage",MALE="Male",FEMAILE="Female",GLOBAL_CHANNEL=1;__awaiter=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})};"use strict";