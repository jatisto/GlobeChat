"use strict";function sendMessage(n){console.log("Message sent : ");connection.send(NEW_MESSAGE,n)}function sendPrivateMessage(n,t){console.log("Private Message sent : ");connection.send(NEW_PRIVATE_MESSAGE,n,t)}function sendInvitation(n){console.log("Invitation sent to : "+n);connection.send(INVITATION_SEND,n)}function acceptInvitation(n){console.log("Accepting conversation : "+n);connection.send(ACCEPT_INVITATION,n)}function rejectInvitation(n){console.log("rejecting conversation : "+n);connection.send(REJECT_INVITATION,n)}function endConversation(n){console.log("ending conversation : "+n);connection.send(ACCEPT_INVITATION,n)}function ajaxRequestParams(n,t,i){return __awaiter(this,void 0,void 0,function*(){return new Promise((r,u)=>{var f=$.ajax({type:n,url:t,data:i});f.done(function(n){r(n)});f.fail(function(n){u(n)})})})}function addMessageToFeed(n,t){var i=new GUIChatFeedElement(feedList,n,t)}function joinChannel(n){return __awaiter(this,void 0,void 0,function*(){yield ajaxRequestParams("POST","api/Channels/"+n+"/join","",null).then(t=>{feedList.html(""),loadChannels(),loadUsers(n),conversations[t]=new Conversation(t),delete conversations[currentChannelName],currentChannelName=t})})}function loadChannels(){var n=ajaxRequestParams("POST","api/getChannels","",null);n.then(function(n){channels=n;channelList.html("");channels.forEach(n=>{n.element=new GUIChannelListElement($(".channel-list"),n);let t=new GUIButton(n.element.selector,"Join",()=>{joinChannel(n.id)});n.element.Render();t.Render();t.selector.addClass("float-right")})})}function loadUsers(n){users=[];var t=ajaxRequestParams("POST","api/Channels/"+n+"/users","",null);t.then(function(n){userList.html("");let t=n;t.forEach(n=>addUserToChannel(n))})}function addUserToChannel(n){try{n.element=new GUIUserListElement($(".user-list"),n);let t=new GUIButton(n.element.selector,"Invite",()=>{sendInvitation(n.login)}),i=new GUIButton(n.element.selector,"Block",()=>{});t.selector.addClass("invite-btn float-right");i.selector.addClass("block-btn float-right");n.element.Render();i.Render();t.Render();users.push(n)}catch(t){console.log(t)}}function removeUserFromList(n){if(console.log("removing user from list "+n),users.length>=0){var t=users.filter(t=>t.login==n)[0];t.element.Remove();console.log("found : "+t.login+" removing");users=users.filter(n=>n.login!=n.login)}}function getBadgeColor(n){return n>100?"badge-danger":n>50?"badge-warning":n>25?"badge-success":"badge-secondary"}function generateRandomString(n){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<n;r++)t+=i.charAt(Math.floor(Math.random()*i.length));return t}function addConversation(n,t){let i=new GUIChatTabElement(chatTabs,n,t);t in conversations&&(i.rejectButton.Remove(),i.acceptButton.Remove(),i.closeButton.Render());chatTabs.append(i.selector);tabs[t]=i.selector}function strip(n){return n.replace(/<(?:.|\n)*?>/gm,"")}var currentChannelName="Global",channelList=$(".channel-list"),userList=$(".user-list"),feedList=$(".feed-list"),chatTabs=$(".chat-tabs"),userMessage=$(".message"),feedTop=$(".feed-top"),channels=[],users=[],pvt=!1,activeConversation="",conversations={},tabs={},backBurton=new GUIButton(feedTop,"Go back to channel",()=>{pvt=!1,conversations[currentChannelName].load()}),CONVERSATION_STATUS,__awaiter;backBurton.Render();userMessage.keypress(function(n){switch(n.key){case"Enter":pvt?sendPrivateMessage(activeConversation,userMessage.val()):sendMessage(userMessage.val());userMessage.val("")}});$(".body").fadeTo("slow",.8);const connection=(new signalR.HubConnectionBuilder).withUrl("/hub").configureLogging(signalR.LogLevel.Information).build();(function(n){n[n.PENDING=0]="PENDING";n[n.ACCEPTED=1]="ACCEPTED";n[n.REJECTED=2]="REJECTED";n[n.BLOCKED=3]="BLOCKED"})(CONVERSATION_STATUS||(CONVERSATION_STATUS={}));const USER_LEFT_CHANNEL="userLeftChannel",USER_JOINED_CHANNEL="userJoinedChannel",USER_CONNECTION_TIMEOUT="userConnectionTimeOut",USER_DISCONNECTED="userDisconnected",CHANNEL_MESSAGE_RECEIVED="channelMessageReceived",PRIVATE_MESSAGE_RECEIVED="privateMessageReceived",INVITATION_RECEIVED="invitationReceived",INVITATION_SEND="invitationSend",ACCEPT_INVITATION="acceptInvitation",REJECT_INVITATION="rejectInvitation",END_CONVERSATION="endConversation",INVITATION_ACCEPTED="invitationAccepted",INVITATION_REJECTED="invitationRejected",NEW_MESSAGE="newMessage",NEW_PRIVATE_MESSAGE="newPrivateMessage",MALE="Male",FEMAILE="Female",GLOBAL_CHANNEL=1;__awaiter=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})};"use strict";